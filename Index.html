<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Shawarma Rehab POS - Fixed</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary: #d32f2f;
            --secondary: #2e7d32;
            --bg: #f8f9fa;
            --white: #ffffff;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--bg); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* --- Login Section (Fixed) --- */
        #loginPage {
            position: fixed; inset: 0; z-index: 9999; background: var(--primary);
            display: flex; align-items: center; justify-content: center;
        }
        .login-card {
            background: white; padding: 30px; border-radius: 12px; width: 90%; max-width: 350px;
            text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .login-card input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px; }
        .login-card button { width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }

        /* --- POS Interface --- */
        #posInterface { display: none; flex-direction: column; height: 100vh; }
        header { background: var(--primary); color: white; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; }
        
        .app-container { display: flex; flex: 1; overflow: hidden; }

        /* Sidebar - Categories */
        .sidebar { width: 150px; background: white; border-right: 1px solid #ddd; overflow-y: auto; flex-shrink: 0; }
        .cat-btn { width: 100%; padding: 15px; border: none; background: none; text-align: left; cursor: pointer; font-weight: 600; border-bottom: 1px solid #f0f0f0; }
        .cat-btn.active { background: #fff5f5; color: var(--primary); border-left: 4px solid var(--primary); }

        /* Menu Grid */
        .menu-grid { flex: 1; padding: 15px; overflow-y: auto; display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 15px; align-content: start; }
        .item-card { background: white; padding: 15px; border-radius: 10px; text-align: center; box-shadow: var(--shadow); cursor: pointer; border: 2px solid transparent; }
        .item-card:hover { border-color: var(--primary); }
        .item-icon { font-size: 2rem; display: block; margin-bottom: 5px; }
        .item-price { color: var(--primary); font-weight: bold; }

        /* Advanced Cart Sidebar */
        .cart-sidebar { width: 350px; background: white; border-left: 1px solid #ddd; display: flex; flex-direction: column; }
        .cart-header { padding: 15px; border-bottom: 2px solid #eee; font-weight: bold; }
        .cart-list { flex: 1; overflow-y: auto; padding: 10px; }
        .cart-row { display: grid; grid-template-columns: 1fr auto auto; gap: 10px; padding: 10px 0; border-bottom: 1px solid #f9f9f9; align-items: center; }
        
        .qty-controls { display: flex; align-items: center; gap: 8px; }
        .qty-btn { width: 24px; height: 24px; border-radius: 50%; border: 1px solid #ddd; background: #eee; cursor: pointer; }

        .cart-footer { padding: 20px; border-top: 2px solid #eee; }
        .total-row { display: flex; justify-content: space-between; font-size: 1.4rem; font-weight: bold; margin-bottom: 15px; }
        .checkout-btn { width: 100%; padding: 15px; background: var(--secondary); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }

        /* Mobile Friendly CSS */
        @media (max-width: 768px) {
            .app-container { flex-direction: column; }
            .sidebar { width: 100%; height: auto; display: flex; overflow-x: auto; border-right: none; border-bottom: 1px solid #ddd; }
            .cat-btn { width: auto; white-space: nowrap; border-bottom: none; border-right: 1px solid #eee; }
            .cart-sidebar { width: 100%; height: 35vh; border-left: none; border-top: 3px solid var(--primary); }
        }
    </style>
</head>
<body>

    <div id="loginPage">
        <div class="login-card">
            <h2>Shawarma Rehab</h2>
            <input type="text" id="username" placeholder="Username (Admin)">
            <input type="password" id="password" placeholder="Password (1234)">
            <button onclick="login()">Login</button>
        </div>
    </div>

    <div id="posInterface">
        <header>
            <div class="brand">SHAWARMA REHAB - Ø´Ø§ÙˆØ±Ù…Ø§ Ø±Ø­Ø§Ø¨</div>
            <button onclick="toggleLang()" style="padding:5px 10px; border-radius:15px; border:none; cursor:pointer;">EN/AR</button>
        </header>

        <div class="app-container">
            <aside class="sidebar" id="catList"></aside>
            <main class="menu-grid" id="menuGrid"></main>
            <aside class="cart-sidebar">
                <div class="cart-header">Current Order</div>
                <div class="cart-list" id="cartList"></div>
                <div class="cart-footer">
                    <div class="total-row">
                        <span>Total</span>
                        <span><span id="totalPrice">0</span> SAR</span>
                    </div>
                    <button class="checkout-btn" onclick="generatePDF()">GENERATE RECEIPT</button>
                </div>
            </aside>
        </div>
    </div>

<script>
    // FIXED LOGIN FUNCTION
    function login() {
        const user = document.getElementById('username').value;
        const pass = document.getElementById('password').value;

        if(user === 'Admin' && pass === '1234') {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('posInterface').style.display = 'flex';
            init();
        } else {
            alert("Wrong credentials");
        }
    }

    const products = [
        { cat: "Shawarma", en: "Regular Shawarma", ar: "Ø´Ø§ÙˆØ±Ù…Ø§ Ø¹Ø§Ø¯ÙŠ", price: 6, icon: "ðŸŒ¯" },
        { cat: "Shawarma", en: "Cheese Shawarma", ar: "Ø´Ø§ÙˆØ±Ù…Ø§ Ø¬ÙŠÙ†", price: 8, icon: "ðŸ§€" },
        { cat: "Shawarma", en: "Arabic Shawarma", ar: "Ø´Ø§ÙˆØ±Ù…Ø§ Ø¹Ø±Ø¨ÙŠ", price: 12, icon: "ðŸ±" },
        { cat: "Burger", en: "Chicken Burger", ar: "Ù‡Ù…Ø¨Ø±Ø¬Ø± Ø¯Ø¬Ø§Ø¬", price: 6, icon: "ðŸ”" },
        { cat: "Fries", en: "Regular Fries", ar: "Ø¨Ø·Ø§Ø·Ø³ Ø¹Ø§Ø¯ÙŠ", price: 5, icon: "ðŸŸ" },
        { cat: "Samosa", en: "Regular Samosa", ar: "Ø³Ù…Ø¨ÙˆØ³Ø© Ø¹Ø§Ø¯ÙŠ", price: 12, icon: "ðŸ¥Ÿ" }
    ];

    let cart = [], lang = 'en', activeCat = 'All';

    function init() {
        renderSidebar();
        renderMenu();
    }

    function renderSidebar() {
        const cats = ['All', ...new Set(products.map(p => p.cat))];
        document.getElementById('catList').innerHTML = cats.map(c => 
            `<button class="cat-btn ${activeCat === c ? 'active' : ''}" onclick="setCat('${c}')">${c}</button>`
        ).join('');
    }

    function renderMenu() {
        const grid = document.getElementById('menuGrid');
        const items = activeCat === 'All' ? products : products.filter(p => p.cat === activeCat);
        grid.innerHTML = items.map(p => `
            <div class="item-card" onclick="addToCart(${products.indexOf(p)})">
                <span class="item-icon">${p.icon}</span>
                <strong style="display:block; min-height:35px;">${lang === 'en' ? p.en : p.ar}</strong>
                <span class="item-price">${p.price} SAR</span>
            </div>
        `).join('');
    }

    function setCat(c) { activeCat = c; renderSidebar(); renderMenu(); }

    function addToCart(idx) {
        const existing = cart.find(i => i.pid === idx);
        if(existing) { existing.qty++; } else { cart.push({ pid: idx, qty: 1 }); }
        updateCart();
    }

    function updateQty(idx, delta) {
        cart[idx].qty += delta;
        if(cart[idx].qty < 1) cart.splice(idx, 1);
        updateCart();
    }

    function updateCart() {
        let total = 0;
        document.getElementById('cartList').innerHTML = cart.map((item, i) => {
            const p = products[item.pid];
            const lineTotal = p.price * item.qty;
            total += lineTotal;
            return `
                <div class="cart-row">
                    <span>${lang === 'en' ? p.en : p.ar}</span>
                    <div class="qty-controls">
                        <button class="qty-btn" onclick="updateQty(${i}, -1)">-</button>
                        <span>${item.qty}</span>
                        <button class="qty-btn" onclick="updateQty(${i}, 1)">+</button>
                    </div>
                    <span style="font-weight:bold;">${lineTotal} SAR</span>
                </div>`;
        }).join('');
        document.getElementById('totalPrice').innerText = total;
    }

    function toggleLang() {
        lang = lang === 'en' ? 'ar' : 'en';
        document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
        renderMenu(); updateCart();
    }

    function generatePDF() {
        if (cart.length === 0) return;
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF({ unit: 'mm', format: [80, 150] });
        doc.text("SHAWARMA REHAB", 40, 10, { align: "center" });
        let y = 20, total = 0;
        cart.forEach(item => {
            const p = products[item.pid];
            const sub = p.price * item.qty;
            total += sub;
            doc.text(`${item.qty}x ${p.en}`, 5, y);
            doc.text(`${sub} SAR`, 75, y, { align: "right" });
            y += 7;
        });
        doc.text(`TOTAL: ${total} SAR`, 75, y + 10, { align: "right" });
        doc.save("Receipt.pdf");
        cart = []; updateCart();
    }
</script>
</body>
</html>
